<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIå†…å®¹ç”Ÿæˆå™¨ - é«˜é“/æœè£…/é€šç”¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html-to-image/1.11.11/html-to-image.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        * { box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans SC', sans-serif; background: #f0f2f5; margin: 0; }
        .card { width: 375px; min-height: 500px; background: white; box-shadow: 0 4px 20px rgba(0,0,0,0.1); margin: 20px auto; overflow: hidden; position: relative; }
        .theme-blue { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .theme-warm { background: #F5F5DC; color: #5D4E37; }
        .theme-neon { background: #39FF14; color: #000; }
        .theme-dark { background: #0a0a0a; color: #fff; }
        .theme-pink { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; }
        .theme-ocean { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; }
        .loading { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .step { display: none; }
        .step.active { display: block; }
        .upload-area { border: 2px dashed #ccc; border-radius: 12px; padding: 40px; text-align: center; cursor: pointer; transition: all 0.2s; }
        .upload-area:hover { border-color: #3b82f6; background: #f0f7ff; }
        .image-preview { max-width: 200px; max-height: 150px; border-radius: 8px; margin-top: 10px; }
        .cover-image { width: 100%; height: 200px; object-fit: cover; }
    </style>
</head>
<body>
    <div style="background: #000; color: #fff; padding: 12px 24px;">
        <div style="max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;">
            <h1 style="font-weight: bold; font-size: 18px;">âœ¨ AIå†…å®¹ç”Ÿæˆå™¨</h1>
            <div style="display: flex; gap: 8px;">
                <button onclick="switchMode('railway')" id="tab-railway" style="padding: 8px 16px; border-radius: 8px; font-size: 14px; font-weight: 500; border: none; cursor: pointer; background: #fff; color: #000;">ğŸš„ é«˜é“å¯¼è§ˆ</button>
                <button onclick="switchMode('fashion')" id="tab-fashion" style="padding: 8px 16px; border-radius: 8px; font-size: 14px; font-weight: 500; border: none; cursor: pointer; background: #374151; color: #fff;">ğŸ‘— æœè£…æ–‡æ¡ˆ</button>
                <button onclick="switchMode('general')" id="tab-general" style="padding: 8px 16px; border-radius: 8px; font-size: 14px; font-weight: 500; border: none; cursor: pointer; background: #374151; color: #fff;">ğŸ“ é€šç”¨æ’ç‰ˆ</button>
            </div>
        </div>
    </div>

    <div style="max-width: 1200px; margin: 0 auto; padding: 24px;">
        <div id="step1" class="step active">
            <div id="mode-railway">
                <div style="background: #fff; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); padding: 32px;">
                    <h2 style="font-size: 24px; font-weight: bold; margin-bottom: 24px;">ğŸš„ é«˜é“å¯¼è§ˆæ–‡æ¡ˆç”Ÿæˆ</h2>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                        <div>
                            <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 8px;">è½¦ç«™åç§° *</label>
                            <input type="text" id="r-station" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px;" placeholder="å¦‚ï¼šåŒ—äº¬å—ç«™">
                        </div>
                        <div>
                            <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 8px;">æœåŠ¡ç‚¹ç±»å‹ *</label>
                            <select id="r-type" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px;">
                                <option value="è¿›ç«™å£">è¿›ç«™å£</option>
                                <option value="å®‰æ£€å£">å®‰æ£€å£</option>
                                <option value="å€™è½¦å¤§å…">å€™è½¦å¤§å…</option>
                                <option value="æ£€ç¥¨å£">æ£€ç¥¨å£</option>
                                <option value="æœåŠ¡å°">æœåŠ¡å°</option>
                                <option value="é¤é¥®è´­ç‰©">é¤é¥®è´­ç‰©</option>
                                <option value="å‡ºç«™æ¢ä¹˜">å‡ºç«™/æ¢ä¹˜</option>
                            </select>
                        </div>
                    </div>
                    <div style="margin: 16px 0;">
                        <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 8px;">ä¸Šä¼ ç°åœºç…§ç‰‡ï¼ˆå¯é€‰ï¼Œä¼šæ˜¾ç¤ºåœ¨å°é¢ï¼‰</label>
                        <div class="upload-area" onclick="document.getElementById('r-image').click()">
                            <div style="font-size: 32px; margin-bottom: 8px;">ğŸ“·</div>
                            <p style="color: #6b7280; font-size: 14px;">ç‚¹å‡»ä¸Šä¼ ç…§ç‰‡</p>
                        </div>
                        <input type="file" id="r-image" accept="image/*" style="display: none;" onchange="handleImage(this)">
                        <div id="r-preview-box" style="display: none; margin-top: 12px;">
                            <img id="r-preview" class="image-preview">
                            <button onclick="clearImage()" style="margin-left: 12px; padding: 6px 12px; background: #ef4444; color: white; border: none; border-radius: 6px; font-size: 12px; cursor: pointer;">åˆ é™¤</button>
                        </div>
                    </div>
                    <button onclick="generateRailway()" style="width: 100%; padding: 14px; background: #3b82f6; color: white; border: none; border-radius: 8px; font-weight: bold; font-size: 16px; cursor: pointer;">âœ¨ ç”Ÿæˆæ–‡æ¡ˆ</button>
                </div>
            </div>

            <div id="mode-fashion" style="display: none;">
                <div style="background: #fff; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); padding: 32px;">
                    <h2 style="font-size: 24px; font-weight: bold; margin-bottom: 24px;">ğŸ‘— æœè£…æ–‡æ¡ˆç”Ÿæˆ</h2>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px;">
                        <div>
                            <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 8px;">æœè£…æè¿° *</label>
                            <input type="text" id="f-desc" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px;" placeholder="å¦‚ï¼šç±³è‰²é’ˆç»‡å¼€è¡«">
                        </div>
                        <div>
                            <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 8px;">é£æ ¼ *</label>
                            <select id="f-style" style="width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px;">
                                <option value="éŸ©ç³»">éŸ©ç³»</option>
                                <option value="æ³•å¼">æ³•å¼</option>
                                <option value="æ—¥ç³»">æ—¥ç³»</option>
                                <option value="é€šå‹¤">é€šå‹¤</option>
                            </select>
                        </div>
                    </div>
                    <div style="margin: 16px 0;">
                        <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 8px;">ä¸Šä¼ æœè£…ç…§ç‰‡ï¼ˆå¯é€‰ï¼‰</label>
                        <div class="upload-area" onclick="document.getElementById('f-image').click()">
                            <div style="font-size: 32px; margin-bottom: 8px;">ğŸ‘•</div>
                            <p style="color: #6b7280; font-size: 14px;">ç‚¹å‡»ä¸Šä¼ ç…§ç‰‡</p>
                        </div>
                        <input type="file" id="f-image" accept="image/*" style="display: none;" onchange="handleImage(this)">
                    </div>
                    <button onclick="generateFashion()" style="width: 100%; padding: 14px; background: #ec4899; color: white; border: none; border-radius: 8px; font-weight: bold; font-size: 16px; cursor: pointer;">âœ¨ ç”Ÿæˆæ–‡æ¡ˆ</button>
                </div>
            </div>
        </div>

        <div id="step2" class="step">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                <div style="background: #fff; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); padding: 24px;">
                    <h2 style="font-size: 20px; font-weight: bold; margin-bottom: 16px;">ğŸ“ ç¼–è¾‘æ–‡æ¡ˆ</h2>
                    <textarea id="edit-content" style="width: 100%; height: 400px; padding: 16px; border: 1px solid #d1d5db; border-radius: 8px; font-family: monospace; font-size: 14px; line-height: 1.6; resize: none;"></textarea>
                    <div style="margin-top: 16px; display: flex; gap: 12px;">
                        <button onclick="document.getElementById('step1').classList.add('active'); document.getElementById('step2').classList.remove('active');" style="padding: 12px 24px; border: 1px solid #d1d5db; border-radius: 8px; background: #fff; cursor: pointer;">â† è¿”å›</button>
                        <button onclick="document.getElementById('step3').classList.add('active'); document.getElementById('step2').classList.remove('active'); renderPreview();" style="flex: 1; padding: 12px; background: #000; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer;">å»æ’ç‰ˆ â†’</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="step3" class="step">
            <div style="display: grid; grid-template-columns: 320px 1fr; gap: 24px;">
                <div style="background: #fff; border-radius: 16px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); padding: 24px;">
                    <h2 style="font-size: 20px; font-weight: bold; margin-bottom: 20px;">ğŸ¨ æ’ç‰ˆè®¾ç½®</h2>
                    
                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 8px;">å°é¢æ ‡é¢˜</label>
                        <input type="text" id="p-title" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px;" oninput="renderPreview()">
                    </div>

                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 8px;">é£æ ¼ä¸»é¢˜</label>
                        <select id="p-theme" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px;" onchange="renderPreview()">
                            <option value="theme-ocean">ğŸŒŠ æµ·æ´‹é£</option>
                            <option value="theme-pink">ğŸŒ¸ ç²‰è‰²é£</option>
                            <option value="theme-blue">ğŸ’™ ç´«è“é£</option>
                            <option value="theme-warm">ğŸ“– ä¹¦å·é£</option>
                            <option value="theme-neon">âš¡ è§å…‰é£</option>
                            <option value="theme-dark">ğŸŒ™ æš—å¤œé£</option>
                        </select>
                    </div>

                    <div style="margin-bottom: 16px;">
                        <label style="display: block; font-size: 14px; font-weight: 500; margin-bottom: 8px;">ä½œè€…ç½²å</label>
                        <input type="text" id="p-author" style="width: 100%; padding: 10px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px;" value="xupaozi" oninput="renderPreview()">
                    </div>

                    <button onclick="downloadCard()" style="width: 100%; padding: 14px; background: #000; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer;">ğŸ“¥ å¯¼å‡ºå›¾ç‰‡</button>
                </div>

                <div style="background: #e5e7eb; border-radius: 16px; padding: 32px; display: flex; justify-content: center;">
                    <div id="preview-card" class="card theme-ocean">
                        <div id="has-image" style="display: none;">
                            <img id="preview-cover-img" class="cover-image">
                        </div>
                        <div style="padding: 32px;">
                            <div id="preview-date" style="font-size: 12px; font-weight: bold; letter-spacing: 2px; margin-bottom: 16px; opacity: 0.7;">VOL.01</div>
                            <h1 id="preview-title" style="font-size: 26px; font-weight: 900; margin-bottom: 16px; line-height: 1.3;">æ ‡é¢˜</h1>
                            <div id="preview-content" style="font-size: 14px; line-height: 1.8;">å†…å®¹...</div>
                            <div style="margin-top: 24px; padding-top: 16px; border-top: 1px solid currentColor; opacity: 0.5; display: flex; justify-content: space-between; font-size: 12px;">
                                <span id="preview-author">xupaozi</span>
                                <span>å°çº¢ä¹¦</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="loading" style="display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); align-items: center; justify-content: center; z-index: 100;">
        <div style="background: white; border-radius: 16px; padding: 40px; text-align: center;">
            <div style="font-size: 48px; margin-bottom: 16px;" class="loading">âœ¨</div>
            <p style="font-weight: bold; font-size: 16px;">AIæ­£åœ¨ç”Ÿæˆæ–‡æ¡ˆ...</p>
        </div>
    </div>

    <script>
        let currentMode = 'railway';
        let currentImage = null;

        function switchMode(mode) {
            currentMode = mode;
            document.getElementById('mode-railway').style.display = mode === 'railway' ? 'block' : 'none';
            document.getElementById('mode-fashion').style.display = mode === 'fashion' ? 'block' : 'none';
            document.getElementById('tab-railway').style.background = mode === 'railway' ? '#fff' : '#374151';
            document.getElementById('tab-railway').style.color = mode === 'railway' ? '#000' : '#fff';
            document.getElementById('tab-fashion').style.background = mode === 'fashion' ? '#ec4899' : '#374151';
            document.getElementById('tab-fashion').style.color = '#fff';
        }

        function handleImage(input) {
            const file = input.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                currentImage = e.target.result;
                document.getElementById('r-preview').src = currentImage;
                document.getElementById('r-preview-box').style.display = 'block';
            };
            reader.readAsDataURL(file);
        }

        function clearImage() {
            currentImage = null;
            document.getElementById('r-image').value = '';
            document.getElementById('r-preview-box').style.display = 'none';
        }

        function generateRailway() {
            const station = document.getElementById('r-station').value || 'XXç«™';
            const type = document.getElementById('r-type').value;
            
            document.getElementById('loading').style.display = 'flex';
            
            setTimeout(() => {
                const content = `ã€${station}${type}æ”»ç•¥ã€‘ç¬¬ä¸€æ¬¡æ¥ä¹Ÿä¸æ…Œï¼\n\nğŸ“ ä½ç½®æŒ‡å¼•\nè¿›å…¥è½¦ç«™åè·ŸéšæŒ‡ç¤ºç‰Œ\n\nâœ¨ å®ç”¨Tipsï¼š\nâ€¢ æå‰30åˆ†é’Ÿåˆ°ç«™\nâ€¢ å¸¦èº«ä»½è¯åˆ·è„¸è¿›\nâ€¢ é«˜å³°æœŸæå‰1å°æ—¶\n\n#é«˜é“å‡ºè¡Œ #${station}`;
                
                document.getElementById('edit-content').value = content;
                document.getElementById('p-title').value = `${station}${type}æ”»ç•¥`;
                document.getElementById('loading').style.display = 'none';
                document.getElementById('step2').classList.add('active');
                document.getElementById('step1').classList.remove('active');
            }, 1500);
        }

        function generateFashion() {
            const desc = document.getElementById('f-desc').value || 'è¿™æ¬¾å•å“';
            const style = document.getElementById('f-style').value;
            
            document.getElementById('loading').style.display = 'flex';
            
            setTimeout(() => {
                const content = `ã€${style}ç©¿æ­ï½œ${desc}å¤ªç»äº†ï¼ã€‘\n\nå§å¦¹ä»¬ï¼æŒ–åˆ°å®äº†ï¼âœ¨\n\nğŸ‘— ç©¿æ­ä¿¡æ¯\n${desc}\né£æ ¼ï¼š${style}\n\nğŸ’• æˆ‘çš„æ„Ÿå—\nâ€¢ é¢æ–™è¶…èˆ’æœ\nâ€¢ ç‰ˆå‹æ˜¾ç˜¦\nâ€¢ é¢œè‰²ç™¾æ­\n\n#${style}ç©¿æ­ #ootd`;
                
                document.getElementById('edit-content').value = content;
                document.getElementById('p-title').value = `${style}ç©¿æ­åˆ†äº«`;
                document.getElementById('loading').style.display = 'none';
                document.getElementById('step2').classList.add('active');
                document.getElementById('step1').classList.remove('active');
            }, 1500);
        }

        function renderPreview() {
            const title = document.getElementById('p-title').value || 'æ ‡é¢˜';
            const author = document.getElementById('p-author').value || 'xupaozi';
            const theme = document.getElementById('p-theme').value;
            const content = document.getElementById('edit-content').value || '';

            document.getElementById('preview-title').textContent = title;
            document.getElementById('preview-author').textContent = author;
            
            // å¤„ç†å†…å®¹
            let displayContent = content
                .replace(/ã€(.+?)ã€‘/g, '<div style="font-weight: bold; font-size: 16px; margin: 12px 0 8px;">$1</div>')
                .replace(/\n/g, '<br>');
            document.getElementById('preview-content').innerHTML = displayContent;

            // åº”ç”¨ä¸»é¢˜
            const card = document.getElementById('preview-card');
            card.className = 'card ' + theme;
            
            // æ˜¾ç¤ºå›¾ç‰‡
            if (currentImage) {
                document.getElementById('has-image').style.display = 'block';
                document.getElementById('preview-cover-img').src = currentImage;
            } else {
                document.getElementById('has-image').style.display = 'none';
            }
        }

        async function downloadCard() {
            const card = document.getElementById('preview-card');
            try {
                const dataUrl = await htmlToImage.toJpeg(card, { quality: 0.95, pixelRatio: 2 });
                saveAs(dataUrl, 'å°çº¢ä¹¦_' + document.getElementById('p-title').value + '.jpg');
            } catch (e) {
                alert('å¯¼å‡ºå¤±è´¥: ' + e);
            }
        }
    </script>
</body>
</html>
